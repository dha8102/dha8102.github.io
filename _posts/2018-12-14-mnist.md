---
layout: post
title: MNIST-기본
categories : [Deep learning]
tags : [Deep learning, Machine learning, MNIST, 모두를 위한 딥러닝, Tensorflow, ]
---

---

<span style = "line-height:50%"><br>

딥 러닝 학습하는 사람들은 누구나 아는, 모르면 간첩인, MNIST 관련 사항을 정리해 본다. MNIST를 정리하면서, 딥 러닝 모델들에서 나올 수 있는 여러 가지 추가할 수 있는 옵션들을 모두 담아 보려고 한다.

## [MNIST - 소개]

기본적으로 소개글은 텐서플로우 문서 한글 번역 사이트에 있는 <a href = "https://tensorflowkorea.gitbooks.io/tensorflow-kr/content/g3doc/tutorials/mnist/beginners/"> MNIST 초급 </a> 페이지를 참고했음을 먼저 밝힌다.

MNIST는 Modified National Institute of Standards and Technology database의 약자로, 손으로 쓴 숫자들로 이루어진 대형 데이터베이스이다. 1995년 미국의 NIST(표준 및 기술협회)에서 취합했던 손글씨 데이터 샘플들을 재혼합 및 보정하여 만들어졌다. 각각의 데이터는 0~9 까지의 숫자를 쓴 그림들이며, 트레이닝 데이터는 60,000개, 테스트 데이터는 10,000개이다. 각 데이터는 28\*28 = 784픽셀로 이루어져 있는 이미지 데이터이며, 클래스는 0~9까지 10개이다.

워낙에 유명한 데이터라서 텐서플로우에 아예 이 데이터를 받을 수 있게 하고 편집도 가능한 라이브러리가 존재한다(!)

아래에는 이 데이터셋을 로드하는 방법부터 시작해서 딥 러닝 모델을 이용해 분류하고 테스트 데이터를 예측까지 해 보는 과정을 정리했다.

## [MNIST - 코드를 통한 이해]

```Python
import tensorflow as tf
import random
import matplotlib.pyplot as plt
tf.set_random_seed(777)  # for reproducibility
```

먼저 필요한 라이브리를 import한다.

```python
from tensorflow.examples.tutorials.mnist import input_data
mnist = input_data.read_data_sets("MNIST_data/", one_hot=True)
```

위와 같은 코드로 mnist 데이터를 로드한다. 보다시피 텐서플로가 로딩을 지원하는 모습을 볼 수 있다. 이미지나 텍스트 파일로만 input을 받다가 이 코드를 처음 봤을 땐 굉장히 당황했다. 어..그럼 이 데이터가 어떤 모양으로 생겼는지는 어떻게 확인하지?

```python
print(mnist.train.images.shape)
print(mnist.validation.images.shape)
print(mnist.test.images.shape)
```

위와 같이 메소드를 차근차근 찾다 보면 shape를 확인할 수 있는 메소드가 존재한다. 위 코드의 출력은 다음과 같다 :

```
(55000, 784)
(5000, 784)
(10000, 784)
```

train data는 55,000개, validation data는 5,000개, test data는 10,000개로 구성되어 있음을 알 수 있다.

(validation은 예비 test를 위한 데이터라고 보면 된다. 그냥 train data와 합쳐도 무관)

마찬가지 방법으로 mnist.train.labels.shape 같은 형식으로 label들의 shape를 찾아보면 10개의 클래스로 나누어져 있는 것을 확인할 수 있다.

그럼 데이터 하나가 어떻게 생겼는지를 자세히 볼까?

`print(mnist.train.images[0])`를 사용해서 첫 번째의 이미지를 출력해 보았더니...

<script type="text/javascript" language="JavaScript">
function layer_toggle(obj) {
        if (obj.style.display == 'none') obj.style.display = 'block';
        else if (obj.style.display == 'block') obj.style.display = 'none';
}
</script>

<div id=more01a style=display:block><a href=# onclick="layer_toggle(document.getElementById('more01a')); layer_toggle(document.getElementById('more01b'));return false;"><p>현재 숨겨진 상태입니다.</p></a></div>
<div id=more01b style=display:none ><a href=# onclick="layer_toggle(document.getElementById('more01a')); layer_toggle(document.getElementById('more01b'));return false;"><p>펼친 상태입니다.</p></a><p>div 사이에 이렇게 내용을 적어주시면 됩니다.</p></div>



<button class="collapsible">펼치기</button>

<div class="collapsible_content">
  <p>[0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.1137255  0.5529412  0.8862746  1.         1.
 1.         0.77647066 0.44705886 0.1137255  0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.22352943 1.
 1.         1.         1.         1.         1.         1.
 1.         0.8862746  0.1137255  0.77647066 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.5529412  1.         0.77647066 0.22352943
 0.         0.         0.         0.1137255  0.6666667  1.
 0.8862746  1.         0.22352943 0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 1.         1.         0.3372549  0.         0.         0.
 0.         0.         0.1137255  1.         1.         0.77647066
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         1.         1.
 0.3372549  0.         0.         0.         0.         0.44705886
 0.8862746  1.         1.         0.3372549  0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.5529412  1.         0.77647066 0.
 0.         0.22352943 0.77647066 1.         1.         0.5529412
 0.1137255  0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.1137255  0.6666667  1.         0.6666667  0.44705886 1.
 1.         0.8862746  0.3372549  0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.1137255
 0.77647066 1.         1.         1.         0.6666667  0.1137255
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.3372549  1.
 1.         0.6666667  0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.1137255  0.8862746  1.         1.         0.8862746
 0.1137255  0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.1137255  0.8862746
 1.         0.6666667  0.5529412  1.         0.77647066 0.1137255
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.5529412  1.         0.77647066 0.
 0.         0.6666667  1.         0.6666667  0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.8862746  1.         0.44705886 0.         0.         0.
 0.8862746  1.         0.1137255  0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.3372549  1.         0.8862746
 0.         0.         0.         0.         0.3372549  1.
 0.5529412  0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.3372549  1.         0.6666667  0.         0.
 0.         0.         0.3372549  1.         0.6666667  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.3372549
 1.         0.6666667  0.         0.         0.         0.
 0.3372549  1.         1.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.3372549  1.         0.6666667
 0.         0.         0.         0.         0.3372549  1.
 1.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.22352943 1.         0.8862746  0.1137255  0.
 0.         0.         0.44705886 1.         1.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.6666667  1.         0.8862746  0.44705886 0.44705886 0.6666667
 1.         1.         0.77647066 0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.22352943 0.6666667
 0.6666667  1.         1.         1.         1.         0.6666667
 0.22352943 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.        ]</p>
</div>





```

```

이렇게 784개의 float형식의 숫자로 이루어진 리스트가 나타난다. 그러니까 28\*28개의 각 픽셀들을 일렬로 쭈욱 나래비 세운 1차원 벡터 형식으로 저장되어 있다 이 말이다.

그럼 각 숫자가 의미하는 바는? 가장 어두운 검정을 